# NDepend GitHub Action

The GitHub Action lets run an NDepend analysis after each rebuild and explore results in a shared interactive HTML+js report. This Action can also fail the build upon some Quality Gate(s) failure.

With a Developer license, the standalone app VisualNDepend.exe or the NDepend Visual Studio extension can be used to explore the result in more details.


## Activate the trial license for your repository

Get the license trial data from the [NDepend web site](  https://www.ndepend.com/activation_githubaction)

Got to the settings of your repository
![alt text](https://docs.github.com/assets/cb-27528/images/help/repository/repo-actions-settings.png)

From the left side bar goto Secrets->Actions, create a new secret named NDependLicense and paste the license data retreived from the ndepend website.

## Usage

The ndepend action must be added after your build and unit testing actions, note that only the license parameter is mandatory.

```yaml
- name: NDepend
    uses: ndepend/ndepend-action@v1
    with:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  
      license: ${{ secrets.NDependLicense }}
```
After the analysis, the ndepend result is stored as artifact of your build, and to explore it you have two options:

- Download the ndepend artifact from your build summary, and open the generated report.
- Access the result from VisualNDepend as explained [here](https://www.ndepend.com/github-doc). 


## Action options

- Custom NDepend Configuration: By default the ndepend action uses the out of the box configuration, so this parameter is not mandatory. However, if you need to use a custom configuration you have to specify the `customconfig` parameter 

```yaml
- name: NDepend
    uses: ndepend/ndepend-action@v1
    with:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  
      license: ${{ secrets.NDependLicense }}
      customconfig: NDependConfigFile.ndproj
```
The NDependConfigFile.ndproj path is relative to your repository root.

- Comparison baseline:
NDepend can report Code Diff since baseline, and to define the ndepend baseline you have to specify the `baseline` parameter 

```yaml
- name: NDepend
    uses: ndepend/ndepend-action@v1
    with:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  
      license: ${{ secrets.NDependLicense }}
      baseline: recent
```

The baseline parameter could have these values:

- recent: to compare with the recent build analyzed by ndepend.
- branchname_recent: To compare with the recent build of the branch with name 'branchname'
- build number: The build number of build already analyzed by NDepend.

- Quality check: stopIfQGFailed
A Quality Gate is a code quality goal.Such quality goal must be enforced before releasing and eventually, before committing to source control.

A Quality Gate can be seen as a PASS/FAIL criterion for software quality.

A dozen of default Quality Gates are proposed by NDepend related to measures like technical debt amount, code coverage or amount of issues with particular severity.

To break the build if at least one quality gate failed, you have to specify the `stopIfQGFailed` parameter 


```yaml
- name: NDepend
    uses: ndepend/ndepend-action@v1
    with:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  
      license: ${{ secrets.NDependLicense }}
      stopIfQGFailed: true
```

- Coverage folder:
Code coverage data is imported from coverage result files generated by the coverage tools.
To import coverage data, you have to specify the `coveragefolder` parameter 

```yaml
- name: NDepend
    uses: ndepend/ndepend-action@v1
    with:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  
      license: ${{ secrets.NDependLicense }}
      coveragefolder: ${{ env.GITHUB_WORKSPACE }}/CoverageOut
```
